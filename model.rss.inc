<?php/** * model file for doing feeds * * @package    content *///include_module ('content/article');/** * class for doing feeds * * @package    content */class rss {    public static function getFeedLink($options){        //$get = 'reference=' . urlencode($options['reference']);                $get = http_build_query($options);        $link = "<p>";        $link.= "<a href=\"http://$_SERVER[HTTP_HOST]";        $link.= "/rss/feed.xml?$get\" ";        $link.= 'rel= "nofollow" target = "_blank">';        $link.= '<img src="/images/rss.gif" alt="rss" border="0"></a>';        $link.= '</p>';        return $link;    }    /**     *     * @return  string  feed string     */    public function getFeed(){        $module = $_GET['reference'];        include_module($module);        $class = moduleLoader::modulePathToClassName($module);        $rows = $class::getRowsRSS();        $str = '';        $str.= $this->getDetails();        $str.= $this->getItems($rows);        return $str;    }    public static function subModuleUserPostContent ($options) {        return self::getFeedLink($options);    }    /**     *     * @return string   details     */    public static function getDetails(){        $details =            "<?xml version=\"1.0\" encoding=\"utf-8\" ?>            <rss version=\"2.0\">                <channel>                    <title>$_SERVER[HTTP_HOST]</title>                    <link>http://$_SERVER[HTTP_HOST]</link>                    <description> " . register::$vars['coscms_main']['description'] . "</description>                    <language>" . register::$vars['coscms_main']['lang'] . "</language>";        return $details;    }    /**     *     * @return  string  items in the feed     */    public static function getItems($rows){        //$rows = $this->getLatest();        $items = '';        // get all items        foreach ($rows as $key => $val){            $items .=               '<item>                <title>'. $val['title'] .'</title>		<link>http://' . $_SERVER['HTTP_HOST'] . article::createArticleLink($val['id']) . '</link>                <description><![CDATA['. $val['abstract'] .']]></description>                <pubDate>' . timestamp_to_pubdate($val['created']) . '</pubDate>' .               '</item>';        }        // end of feed        $items .= '</channel>                   </rss>';        return $items;    }}/** * function for transforming unix timestamp to string *  * @param  int      unix timestamp to be converted * @return string   with formatted unix timestamp */function timestamp_to_pubdate ($ts){    return date ('D, M d Y H:i:s O', strtotime ($ts));}